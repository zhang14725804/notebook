### å¦‚ä½•å­¦ä¹ 

å®˜æ–¹æ–‡æ¡£ã€ä¸€æ‰‹èµ„æ–™ï¼Œå°½é‡è‹±æ–‡ç‰ˆ

[effective_go](https://golang.org/doc/effective_go)


## å¼‚å¸¸å¤„ç†

    Error vs Exception
    Error Type
    Handling error
    Go1.13 errors ï¼ˆerror wrapï¼Œå‘ä¸ŠæŠ›errorï¼Œè€Œä¸æ˜¯åœ¨ä¸‰å±‚æ¶æ„ä¸­é‡å¤çš„æ¯ä¸€å±‚éƒ½æŠ›errorï¼‰
    Go2 error Inspection
    Referanceï¼ˆä¸€äº›å»ºè®®é˜…è¯»çš„æ–‡ç« ï¼‰


### error



```golang
// New returns an error that formats as the given text.
// Each call to New returns a distinct error value even if the text is identical.
func New(text string) error {
    // ğŸ˜…ğŸ˜…ğŸ˜… questionï¼šæ ‡å‡†åº“ä¸ºä»€ä¹ˆè¿™ä¹ˆåš
	return &errorString{text}
}

// errorString is a trivial implementation of error.
type errorString struct {
	s string
}

func (e *errorString) Error() string {
	return e.s
}
```

## Error vs Exception

Cã€C++ã€Javaè¯­è¨€æ¼”è¿›å†å²

panicï¼Œé‡ç”Ÿgoroutineé—®é¢˜ï¼ˆgoåç¨‹ä¸­panicï¼‰


é‡ç”Ÿgoroutineå¦‚ä½•å¤„ç†ã€‚deferæ‹¦æˆª

ã€å¼ºä¾èµ–ã€‘ï¼Œã€å¼±ä¾èµ–ã€‘ï¼ˆğŸ˜…ï¼‰ï¼ŒBlockingæˆ–è€…None Blocking

### panicåœºæ™¯(game overçš„åœºæ™¯)

panicåœºæ™¯ï¼šï¼ˆ1ï¼‰mainå‡½æ•°åˆå§‹åŒ–ï¼›ï¼ˆ2ï¼‰initèµ„æºåˆå§‹åŒ–ï¼ˆğŸ˜…ï¼‰ï¼ˆ3ï¼‰ä¸å¯æ¢å¤çš„ç¨‹åºé”™è¯¯ï¼›ä¸šåŠ¡é€»è¾‘ä¸è¦panic

daoå±‚æŸ¥è¯¢è®°å½•æŸ¥ä¸åˆ°ï¼Œå¦‚ä½•è¿”å›ã€‚ç©ºæŒ‡é’ˆè¿˜æ˜¯errorï¼ˆğŸ˜…ï¼‰

ä¼˜å…ˆè€ƒè™‘å¤±è´¥ï¼Œè€Œä¸æ˜¯æˆåŠŸ


## Error Type ï¼ˆğŸ˜…ï¼‰

ï¼ˆ1ï¼‰Sentinel Errorï¼ˆå¸¸é‡é¢„å®šä¹‰ï¼ŒåŒ…çº§åˆ«çš„errorï¼Œæ— æ³•æºå¸¦ä¸Šä¸‹æ–‡ï¼‰

ï¼ˆ2ï¼‰Error Typeï¼ˆè‡ªå®šä¹‰MyStructï¼‰

ï¼ˆ3ï¼‰Opaque errorsï¼ˆéé€æ˜çš„é”™è¯¯å¤„ç†ï¼‰

3ä¸­å§¿åŠ¿ã€å¥—è·¯

## Handling errorï¼ˆå¦‚ä½•å†™çš„é—®é¢˜ ğŸ˜…ï¼‰

ï¼ˆ1ï¼‰Indented flow is for errorï¼ˆæ— é”™è¯¯çš„æ­£å¸¸æµç¨‹ä»£ç ï¼Œä»£ç æ— ç¼©è¿›ï¼ˆç±»ä¼¼äºå›è°ƒåœ°ç‹±ï¼‰ï¼Œé”™è¯¯æå‰å¤„ç†ï¼‰

ï¼ˆ2ï¼‰Eliminate error handling by eliminating errorï¼ˆğŸ˜…ğŸ˜…ğŸ˜…ï¼‰

### Wrap error

- é”™è¯¯è¦è¢«æ—¥å¿—è®°å½•
- åº”ç”¨ç¨‹åºå¤„ç†é”™è¯¯æ—¥å¿—ï¼Œä¿è¯100%å®Œæ•´æ€§ï¼ˆå¦‚æœè¦åæ‰é”™è¯¯ï¼Œä¸€å®šè¦æŠŠvalueå€¼åšå¤„ç†ï¼Œé™çº§å¤„ç†æˆ–è€…ç»™é»˜è®¤å€¼ï¼‰
- ä¹‹åä¸å†æŠ¥å‘Šå½“å‰é”™è¯¯

ã€github.com/pkg/errors æ¨èä½¿ç”¨ã€‘ï¼ˆåŒ…å«äº†é”™è¯¯å †æ ˆä¿¡æ¯ï¼Œæºå¸¦æœ€åº•å±‚çš„é”™è¯¯åŸå› ï¼Œåˆå¯ä»¥å¸¦å¾ˆå¤šä¸Šä¸‹æ–‡ ğŸ˜…ğŸ˜…ğŸ˜…ï¼‰

### å¦‚ä½•æ­£ç¡®ä½¿ç”¨wrapï¼ˆğŸ˜…ğŸ˜…ğŸ˜…ï¼‰

åº”ç”¨ç¨‹åºwapï¼ŒkitåŸºç¡€åº“ä¸ç”¨


## Go1.13 errors

å‚è€ƒäº†github.com/pkg/errors

### Error Before Go1.13

### Go1.13ï¼Œæä¾›äº†ã€Isã€‘å’Œã€Asã€‘ï¼Œå¢åŠ äº†ã€%wã€‘


## é—®é¢˜ï¼ˆæ²¡æœ‰çœ‹ï¼‰

    åº•å±‚å¦‚dbå±‚å‡ºç°ä¸€ä¸ªé”™è¯¯ï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿæ˜¯ç›´æ¥è¿”å›errorï¼Œè¿˜æ˜¯åŒ…ä¸€å±‚æŠ›ç»™ä¸Šå±‚ã€‚


