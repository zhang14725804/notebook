## 为什么MySQL要用B+树存储索引

### 二叉搜索树（也叫二叉排序树、二叉查找树）

它或者是一棵空树，或者是具有下列性质的二叉树： 最多有左右两个节点，若它的左子树不空，则左子树上所有结点的值均【小于】它的根结点的值； 若它的右子树不空，则右子树上所有结点的值均【大于】它的根结点的值； 它的左、右子树也分别为二叉排序树。

极端情况：有序序列，二叉搜索树退化成【链表】


### AVL树

带有平衡条件的二叉查找树，一般是用平衡因子差值判断是否平衡并通过旋转来实现平衡，左右子树树高不超过1

### 红黑树（为什么这么设计）

一种二叉查找树，但在每个节点增加一个存储位表示节点的颜色，可以是red或black（非红即黑）。通过对任何一条从根到叶子的路径上各个节点着色的方式的限制，红黑树确保没有一条路径会比其它路径长出两倍。它是一种弱平衡二叉树

保证树的平衡性：树的查找性能取决于树的高度，让树尽可能平衡，就是降低树的高度

### B树（为什么这么设计），常用于

使用场景：【文件系统】

一种多路搜索树，每个节点可以拥有多于两个孩子节点。M路的B树，最多能拥有M个孩子节点

无限多路，B树就退化成有序数组了。

为什么文件系统的索引用【B树】而不用【红黑树】或者【有序数组】

文件系统和数据库的索引都是存在硬盘上的，并且如果数据量大的话，不一定能一次性加载到内存中

如果一棵树无法一次性加载进内存，可以每次加载B树的一个节点，然后一步步查找

如果在内存中，【红黑树】比【B树】效率更高，但涉及到磁盘操作，B树就更优秀。

如果这些节点存储在外存储器中，每访问一个节点，相当于就是进行了一次I/O操作，随着树高度的增加，频繁的I/O操作一定会降低查询的效率。

### B+树（为什么这么设计）

使用场景：【数据库索引】

【B+树】是在【B树】上进行改造，所有数据都在叶子节点，同时叶子节点之间还存在指针形成链表

数据库中select数据，不一定只选一条，很多时候会选多条，比如按照id排序后选10条。

如果是多条的话，B树需要做局部的中序遍历，可能要跨层访问。而B+树由于所有数据都在叶子结点，不用跨层，同时由于有链表结构，只需要找到首尾，通过链表就能把所有数据取出来了

### 为什么不用hash而用B+树存数据库索引

这和业务场景有关。如果只选一个数据，那确实是hash更快。但是数据库中经常会选择多条，这时候由于B+树索引有序，并且又有链表相连，它的查询效率比hash就快很多了。

而且数据库中的索引一般是在磁盘上，数据量大的情况可能无法一次装入内存，B+树的设计可以允许数据分批加载，同时树的高度较低，提高查找效率。

### Trie 树

### R树